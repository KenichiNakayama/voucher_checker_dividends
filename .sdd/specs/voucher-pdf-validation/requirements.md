# 要件定義書

## 機能概要
配当バウチャーのPDFをアップロードして必須要素を検証し、基幹システムでの計上に必要な情報を抽出・可視化するStreamlitアプリの中核機能。

## ユーザーストーリー
- 経理担当者として、アップロードした配当バウチャーが要件を満たしているか確認したい。なぜなら基幹システムへ正確に計上する責任があるから。

## 機能要件
### 要件1：バウチャーアップロードUI
- 利用者がPDF形式のバウチャーをアプリにアップロードできるUIを提供する。
- 受入基準：
  - [ ] UIがPDFファイルアップロードを受け付け、選択したファイル名を表示すること。
  - [ ] アップロード完了後にアプリがファイル内容を解析処理へ渡せる状態で保持すること。

### 要件2：バウチャー要件検証
- アップロードしたバウチャーが必要項目（文書タイトル、会社名、配当決議日、配当金額）を満たしているか自動判定する。
- 受入基準：
  - [ ] 各必須項目について検証結果（満たす／不足）が画面で判別できること。
  - [ ] 必須項目が欠落または判定できない場合、理由を示して利用者に警告すること。

### 要件3：基幹システム向け情報抽出
- バウチャーから配当決議会社名、決議日、配当金額など計上に必要な情報を抽出する。
- 受入基準：
  - [ ] 抽出した各項目の値がテキストとして画面に表示されること。
  - [ ] 抽出できなかった項目には未取得であることが分かる表示があること。

### 要件4：根拠ハイライト表示
- 抽出・判定に使用したバウチャー内の箇所をPDFビュー上で黄色ハイライトする。
- 受入基準：
  - [ ] 各抽出項目に対応するハイライト位置がビュー上で確認できること。
  - [ ] ハイライト表示と抽出結果が対応づけられ、利用者が根拠を追跡できること。

### 要件5：ハイライト付きPDFダウンロード
- 根拠を示すハイライトを付与したPDFを利用者がダウンロードできるようにする。
- 受入基準：
  - [ ] 判定完了後にハイライト付きPDFのダウンロード操作が提供されること。
  - [ ] ダウンロードしたPDFにアプリで表示したハイライトが正しく反映されていること。

### 要件6：解析APIプロバイダの選択
- バウチャー解析に利用するAI APIとしてOpenAIまたはClaudeを選択できる設定を提供する。
- 受入基準：
  - [ ] 利用者がOpenAIとClaudeのいずれかをUI上で選択できること。
  - [ ] 選択したプロバイダに応じて対応するAPIキー・エンドポイントでリクエストが送信されること。

## 非機能要件
- パフォーマンス：通常サイズのPDF（数ページ）を数秒程度で解析し、利用者が待機可能な体験を提供する。
- セキュリティ：アップロードしたファイルはセッション内でのみ保持し、不要になったら破棄できる設計とする。APIキーは安全に管理し、ログなどに出力しない。
